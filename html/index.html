<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Option Pricing with the Crank Nicolson Method: Crank Nicolson scheme for pricing Vanilla Options</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="paris-saclay-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Option Pricing with the Crank Nicolson Method<span id="projectnumber">&#160;v24.1</span>
   </div>
   <div id="projectbrief">Nikolaou K., Spadafina F.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Crank Nicolson scheme for pricing Vanilla Options </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This class concerns the simple case of a vanilla option with no dividents. We seperate our options into European or American, Put or Call, and use the Crank Nicolson finite differnecing scheme to approximate the solution the Black Scholes equation. The class can also compute the five basic Greeks of the option (Delta, Gamma, Theta, Rho, and Vega), compare the difference in value between European and American option ceteris paribus, and validate the accuracy of the model using the explicit Black Scholes model. Additionally the class can handle time variant risk free interest rate. By adding at leat one value of the rate in any time point between computation date and maturity, the class will linearly interpolate the rest of the time points.</p>
<h2><a class="anchor" id="autotoc_md0"></a>
Getting Started</h2>
<p>Simply include the class header, plus some common libraries, string.h, vector.h and utility.h (for using std::pairs).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;utility&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;CN.h&quot;</span></div>
<div class="line"><a class="code hl_class" href="class_c_n.html">CN</a> object(...);</div>
<div class="line">std::vector&lt;std::vector&lt;double&gt;&gt; optionPrices = <span class="keywordtype">object</span>.solve();</div>
<div class="ttc" id="aclass_c_n_html"><div class="ttname"><a href="class_c_n.html">CN</a></div><div class="ttdoc">This class performs the Crank Nicolson finite differencing scheme for pricing European and American O...</div><div class="ttdef"><b>Definition</b> CN.h:21</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1"></a>
Crank Nicolson finite differencing method</h2>
<div class="image">
<img src="grid.png" alt=""/>
</div>
<p>The Crank-Nicholson method is widely used for solving time-dependent partial differential equations, particularly the heat equation and diffusion problems. It is an implicit, finite difference method that combines the features of both the forward Euler and backward Euler methods, balancing between stability and accuracy. Its key features are:</p>
<ul>
<li><b>Unconditional Stability:</b> The method is stable regardless of time step size.</li>
<li><b>Second-Order Accuracy:</b> The scheme achieves second-order accuracy in both space and time.</li>
<li><b>Implicit Time-Stepping:</b> Unlike explicit methods, it allows for larger time steps without instability.</li>
</ul>
<p>It transforms the partial differential equation into a system of linear equations that can be efficiently solved using a tridiagonal matrix algorithm.</p>
<p>The Black-Scholes equation is given by:   </p><p class="formulaDsp">
\[
  \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + rS \frac{\partial V}{\partial S} - rV = 0,
  \]
</p>
<p> where:</p><ul>
<li>\( V(S, t) \) is the option price as a function of stock price \( S \) and time \( t \).</li>
<li>\( \sigma \) is the volatility.</li>
<li>\( r \) is the risk-free interest rate.</li>
</ul>
<p>Using the Crank-Nicolson method, the discretized equation at grid point \( i \) becomes:   </p><p class="formulaDsp">
\[
  a_i V_{i-1}^{n+1} + b_i V_i^{n+1} + c_i V_{i+1}^{n+1} = d_i,
  \]
</p>
<p> where:        </p><p class="formulaDsp">
\begin{align*}
  a_i &amp;= -\frac{\Delta t}{4} \left( \sigma^2 i^2 - ri \right), \\
  b_i &amp;= 1 + \frac{\Delta t}{2} \left( \sigma^2 i^2 + r \right), \\
  c_i &amp;= -\frac{\Delta t}{4} \left( \sigma^2 i^2 + ri \right), \\
  d_i &amp;= \frac{\Delta t}{4} \left( \sigma^2 i^2 - ri \right) V_{i-1}^n \\
       &amp;\quad + \left( 1 - \frac{\Delta t}{2} \left( \sigma^2 i^2 + r \right) \right) V_i^n \\
       &amp;\quad + \frac{\Delta t}{4} \left( \sigma^2 i^2 + ri \right) V_{i+1}^n.
  \end{align*}
</p>
<p>This leads to a tridiagonal matrix system that can be solved efficiently using the Thomas algorithm.</p>
<p>The Option Greeks are calculated using simple forward or central differencing schemes of the options's value over the respective difference or pertrubation.</p>
<p>Advantages:</p><ul>
<li>Coverges in Error faster than Implicit/Explicit method as number of timesteps increases</li>
<li>Suitable for large time step simulations without instability.</li>
<li>Efficient when solved using methods like the Thomas algorithm for tridiagonal systems.</li>
</ul>
<div class="image">
<img src="convergence.png" alt=""/>
</div>
<p>Reference for both images <a href="https://quintus-zhang.github.io/post/on_pricing_options_with_finite_difference_methods/">here</a>.</p>
<p>See Also:</p><ul>
<li><a href="https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_equation">Black-Scholes Equation</a></li>
<li><a href="https://en.wikipedia.org/wiki/Numerical_methods">Numerical Methods Overview</a></li>
<li><a href="https://en.wikipedia.org/wiki/Crank%E2%80%93Nicolson_method">Crank-Nicolson Method</a></li>
<li><a href="https://shorturl.at/x9uWg">Option Greeks</a></li>
<li><a href="https://quintus-zhang.github.io/post/on_pricing_options_with_finite_difference_methods/">On pricing options with finite difference methods</a> </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
